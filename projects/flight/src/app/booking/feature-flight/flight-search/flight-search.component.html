<ng-container *ngIf="flights() as flights">

  <div class="card">
    <div class="card-header">
      <h2 class="card-title">Flight Search</h2>
    </div>

    <div class="card-body">

      <app-flight-filter
        [filter]="filter()"
        (searchTrigger)="search($event)"
        #flightFilter
        >
        <div *ngIf="flights.length" class="flight-filter-info">
          {{ flights.length }} flights found!
        </div>
        <button *ngIf="flights.length" (click)="reset()"
          class="btn btn-default flight-filter-button"
        >Reset</button>
      </app-flight-filter>

      <p>{{ flightDetails() }}</p>

    </div>
  </div>

  @defer (on interaction(flightFilter)  ) {
    <div class="row">
      <div *ngFor="let flight of flights" class="col-xs-12 col-sm-6 col-md-4">
          <app-flight-card
            [item]="flight"
            [(selected)]="basket[flight.id]"
            (delayTrigger)="delay($event)"
          />
        </div>
    </div>
  } @placeholder {
    Result view will available on time.
  }

  @defer (on timer(5000)) {
    <div class="card">
      <div class="card-header">
        <h2 class="card-title">Basket</h2>
      </div>

      <div class="card-body">
        <pre>{{ basket | json }}</pre>
      </div>
    </div>
  } @placeholder {
    <p>
      Basket not available yet.<br>
      Please wait until it shows up in 5 seconds.
    </p>
  }

</ng-container>
